<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Weight360</title>
  <meta name="theme-color" content="#0f1724">
  <style>
    :root{
      --bg:#0f1724;--card:#0b1220;--accent:#60a5fa;--muted:#94a3b8;--gold:#ffd166;--pink:#f472b6;color-scheme:dark
    }
    html,body{margin:0;background:linear-gradient(180deg,#071026 0%, #071827 100%);color:#e6eef8;
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial}
    .wrap{max-width:980px;margin:16px auto;padding:0 14px}
    header.hero{display:flex;flex-direction:column;gap:12px;margin-bottom:16px;padding:18px 20px;border-radius:16px;background:linear-gradient(135deg, rgba(255,95,162,0.18), rgba(96,165,250,0.12));border:1px solid rgba(255,95,162,0.35);box-shadow:0 10px 30px rgba(2,6,23,0.45)}
    h1{font-size:1.4rem;margin:0;color:var(--pink)}
    .tiny{font-size:.9rem}.muted{color:var(--muted)}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:12px;padding:0;margin-bottom:14px;box-shadow:0 6px 20px rgba(2,6,23,0.6);border:1px solid var(--pink)}
    .card summary{cursor:pointer;display:flex;justify-content:space-between;align-items:center;padding:14px;font-size:1rem;color:var(--pink)}
    .card summary::after{content:"▶";color:var(--pink);transition:transform .3s}
    .card[open] summary::after{transform:rotate(90deg)}
    .card .content{padding:0 14px 14px}
    input,button{padding:6px 8px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);
      background:transparent;color:inherit;min-height:34px;font-size:.9rem}
    input[type="date"]{min-width:120px}
    .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    .grow{flex:1 1 200px}
    .right{margin-left:auto}
    .pill{padding:6px 10px;border-radius:999px;background:rgba(255,255,255,0.06)}
    .section-title{font-size:1rem;margin:0;color:var(--pink)}

    /* CHART */
    #chartWrap { position: relative; height: 320px; width: 100%; }
    #weightChart { position: absolute; inset: 0; width: 100% !important; height: 100% !important; display: block; }

    .chart-row{display:flex;gap:12px;align-items:flex-start}
    .stats{flex:1 1 35%;display:flex;flex-direction:column;gap:8px}
    .stat{background:rgba(255,255,255,0.02);padding:10px;border-radius:8px}
    .bar{height:12px;border-radius:8px;background:#1f2a44;overflow:hidden}
    .bar>span{display:block;height:100%;background:var(--gold);width:0%}
    table{width:100%;border-collapse:collapse;margin-top:8px}
    th,td{padding:8px;text-align:left;border-bottom:1px dashed rgba(255,255,255,0.06);font-size:.95rem}
    @media(max-width:780px){.chart-row{flex-direction:column}}
  </style>
</head>
<body>
  <div class="wrap">
    <header class="hero">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:20px;flex-wrap:wrap">
        <div>
          <h1>Weight360</h1>
          <div class="tiny muted">Private weight & calorie tracker — saved locally on this device</div>
          <div class="tiny muted" style="margin-top:6px">Target date: <b id="targetDateLbl">Jan 1, 2026</b></div>
          <div class="row" style="margin-top:8px">
            <input id="nameInput" placeholder="Your name" style="width:160px">
            <button id="saveName" type="button">Set</button>
            <button id="clearName" type="button">Clear</button>
            <span class="pill tiny">Hi, <b id="nameDisplay">—</b></span>
          </div>
        </div>
        <div style="display:flex;gap:10px;align-items:flex-end;flex-wrap:wrap">
          <div class="row" style="gap:6px">
            <input type="number" step="0.1" id="quickWeight" placeholder="Weight" style="width:100px">
            <button id="quickWeightBtn" type="button">Add</button>
          </div>
          <div class="row" style="gap:6px">
            <input type="number" id="quickCalories" placeholder="Calories" style="width:100px">
            <button id="quickCaloriesBtn" type="button">Add</button>
          </div>
          <div class="row" style="gap:6px">
            <input type="number" id="quickWater" placeholder="Water (cups)" style="width:100px">
            <button id="quickWaterBtn" type="button">Add</button>
          </div>
        </div>
      </div>
      <div style="display:flex;align-items:center;justify-content:space-between;gap:20px;margin-top:10px">
        <div class="bar" style="flex:1"><span id="headerProgressBar"></span></div>
        <div class="tiny muted">Current weight: <b id="currentWeightLbl">—</b></div>
        <div class="tiny muted" id="headerProgressLabel">0%</div>
      </div>
    </header>

    <!-- WEIGHT TRACKER -->
    <details class="card" open>
      <summary>Weight Tracker</summary>
      <div class="content">
        <div class="row">
          <div class="grow">
            <label class="tiny muted">Date</label><br/>
            <input type="date" id="date">
          </div>
          <div>
            <label class="tiny muted">Weight (lbs)</label><br/>
            <input type="number" step="0.1" id="weight" placeholder="e.g. 238.6">
          </div>
          <div class="grow">
            <label class="tiny muted">Notes</label><br/>
            <input type="text" id="notes" placeholder="morning weigh-in, gym, etc.">
          </div>
          <div>
            <button id="addWeight" type="button">Add</button>
            <button id="saveWeight" type="button" style="display:none">Save</button>
          </div>
        </div>
        <div class="row" style="margin-top:10px;align-items:center;gap:8px">
          <label class="tiny muted">Goal (lbs)</label>
          <input type="number" step="0.1" id="goal" placeholder="190" style="width:120px">
          <button id="saveGoal" type="button">Set</button>
          <button id="clearGoal" type="button" title="Clear saved goal">Clear</button>
          <span class="pill tiny">Current goal: <b id="hdrGoal">—</b></span>
        </div>
      </div>
    </details>

    <!-- FOOD & CALORIES -->
    <details class="card">
      <summary>Food & Calories</summary>
      <div class="content">
        <div class="row">
          <div><label class="tiny muted">Date</label><br/><input type="date" id="foodDate"></div>
          <div class="grow"><label class="tiny muted">Food</label><br/><input id="foodName" placeholder="eggs & toast"></div>
          <div><label class="tiny muted">Calories</label><br/><input type="number" id="foodCals" placeholder="320"></div>
          <div><button id="addFood" type="button">Add food</button></div>
          <div class="right">
            <label class="tiny muted">Maintenance kcal/day</label><br/>
            <input type="number" id="maintKcal" placeholder="auto" style="width:160px">
            <button id="autoMaint" type="button" title="Rough estimate: 12 × current weight">Auto</button>
          </div>
        </div>
        <div class="row tiny" style="margin-top:8px">
          <span class="pill">Today total: <b id="todayTotal">0</b> kcal</span>
          <span class="pill">Remaining vs max: <b id="todayRemain">—</b></span>
        </div>
        <div style="overflow:auto;max-height:240px;margin-top:10px">
          <table id="foodTable">
            <thead><tr><th>Date</th><th>Food</th><th>Calories</th><th></th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </details>

    <!-- HYDRATION -->
    <details class="card">
      <summary>Hydration</summary>
      <div class="content">
        <div class="row tiny">
          <span class="pill">Today water: <b id="todayWater">0</b> cups</span>
        </div>
        <div style="overflow:auto;max-height:240px;margin-top:10px">
          <table id="waterTable">
            <thead><tr><th>Date</th><th>Cups</th><th></th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </details>

    <!-- CHART + STATS -->
    <details class="card">
      <summary>Chart & Stats</summary>
      <div class="content chart-row">
        <div id="chartWrap" class="grow">
          <canvas id="weightChart"></canvas>
          <div class="tiny muted" style="margin-top:6px">Progress toward goal</div>
          <div class="bar"><span id="progressBar"></span></div>
          <div class="tiny muted" id="progressLabel" style="margin-top:4px">0%</div>
        </div>
        <div class="stats">
          <div class="stat"><div class="tiny muted">First recorded</div><div id="firstVal">—</div></div>
          <div class="stat"><div class="tiny muted">Latest</div><div id="latestVal">—</div></div>
          <div class="stat"><div class="tiny muted">Change</div><div id="changeVal">—</div></div>
          <div class="stat"><div class="tiny muted">Avg/week</div><div id="rateVal">—</div></div>
          <div class="stat"><div class="tiny muted">Days left</div><div id="daysLeftVal">—</div></div>
        </div>
      </div>
    </details>

    <!-- WEIGHT ENTRIES -->
    <details class="card">
      <summary>Weight Entries</summary>
      <div class="content">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div class="tiny muted">Click a row to edit or delete</div>
        </div>
        <div style="overflow:auto;max-height:260px">
          <table id="logTable">
            <thead><tr><th>Date</th><th>Weight</th><th>Notes</th><th></th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="row" style="margin-top:8px">
          <button id="clearAll" type="button">Clear ALL data</button>
          <small class="muted">Data is stored locally in this browser.</small>
        </div>
        <div class="row" style="margin-top:8px">
          <button id="exportCsv" type="button">Export CSV</button>
          <input type="file" id="importCsv" accept=".csv" />
        </div>
      </div>
    </details>
  </div>

  <script>
    // Simple local name set
    document.getElementById('saveName').onclick=()=>{
      const n=document.getElementById('nameInput').value.trim();
      document.getElementById('nameDisplay').textContent=n||'—';
      localStorage.setItem('w360_name',n);
    };
    document.getElementById('clearName').onclick=()=>{
      document.getElementById('nameInput').value='';
      document.getElementById('nameDisplay').textContent='—';
      localStorage.removeItem('w360_name');
    };
    window.addEventListener('load',()=>{
      const n=localStorage.getItem('w360_name');
      if(n){document.getElementById('nameInput').value=n;document.getElementById('nameDisplay').textContent=n;}
    });

    // Clear all data confirm
    document.getElementById('clearAll').onclick=()=>{
      const ans=prompt('Are you sure? Type "yes" to clear ALL data and start over.');
      if(ans && ans.toLowerCase()==='yes'){
        localStorage.clear();
        location.reload();
      }
    };
  </script>
</body>
</html>
